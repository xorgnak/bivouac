<style>
<% [ :html, :button, :input, :select ].each do |e| %>
<%= e %> { font-family: monospace; font-size: x-large; max-width: 100%; }
<% end %>
body { margin: 0; padding: 0; }
.material-icons { vertical-align: middle; }
<%= erb @host.app[:css] || '' %>
</style>
<% @ts = Time.now.utc.to_i %>

<meta name="viewport" content="initial-scale=1, maximum-scale=1">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<% if params.has_key?(:u) %>
  <% if params.has_key?(:x) %>
<link rel="manifest" href="<%= @path %>/manifest.webmanifest?u=<%= params[:u] %>&x=<%= params[:x] || 'solo' %>&ts=<%= params[:ts] || @ts %>" crossorigin="use-credentials" />
  <% else %>
<link rel="manifest" href="<%= @path %>/manifest.webmanifest?u=<%= params[:u] %>" crossorigin="use-credentials" />
  <% end %>
<% end %>
<!-- mqtt broker -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.1.0/paho-mqtt.js'></script>
<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
<!-- qr generator/scanner -->
<script src="https://cdn.jsdelivr.net/npm/jquery.qrcode@1.0.3/jquery.qrcode.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
<!-- charts and images -->
<!-- <script src="https://cdn.plot.ly/plotly-2.8.3.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script> -->

<title><%= @host.id %></title>
<form id='post' action='/' method='POST'></form>
<form id='auth' action='/auth' method='POST'></form>
<form id='file' action='/<%= params[:entity] || @id %>' method='POST' enctype='multipart/form-data'></form>
<form id='chat' action='/chat' method='POST'></form>
<form id='form'>
<input type='hidden' id='entity' name='entity' value='<%= params[:entity] || @id %>'>
<%= yield %>
</form>
<script>
function log(s) { $('#log').append('<p>' + s + '</p>') }
$(function() {
$(document).on('click', '.tog', function(ev) {
ev.preventDefault();
$('.foot').hide();
$('#' + $(this).val()).show();
});
$(document).on('click', '.goto', function(ev) {
ev.preventDefault();
document.localtion = $(this).val();
});
});
</script>